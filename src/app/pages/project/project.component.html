<div *ngIf="currentProject" id="profile-upper">
  <div id="profile-banner-image">
    <img src="https://imagizer.imageshack.com/img921/9628/VIaL8H.jpg" alt="Banner image">
  </div>
  <div id="profile-d">
    <div id="profile-pic">
      <img src="https://imagizer.imageshack.com/img921/3072/rqkhIb.jpg">
    </div>
    <!--  <div id="u-name">Himalaya Singh</div> -->

    <div *ngIf="currentProject?.owner == currentUser?.id" id="edit-profile"><i class="material-icons">camera_alt</i>
    </div>
  </div>
  <div id="black-grd"></div>
</div>
<div *ngIf="currentProject" class="row mt-24">
  <div class="col-md-3 text-right">

  </div>
  <div class="col-md-5">
    <h1>{{this.currentProject?.name}}</h1>
  </div>

  <div class="col-md-4 text-right  btn_items">

    <button type="button" class="btn btn_item" *ngIf="currentProject?.owner !== currentUser?.id" (click)="onChat()"><i
        class="far fa-comment-alt"></i>
      訊息</button>
    <button type="button" class="btn btn_item" *ngIf="currentProject?.owner !== currentUser?.id"
      (click)="onClickFollow()"><i class="fas fa-plus"></i>
      追蹤</button>
    <button type="button" class="btn btn_item" *ngIf="currentProject?.owner !== currentUser?.id"
      (click)="onClickCollect()"><i class="far fa-bookmark fa-lg"></i>
      收藏</button>
  </div>
</div>
<div *ngIf="currentProject" class="row mt-10">
  <div class="col-md-3 text-right">

  </div>
  <div class="col-md-6">
    <a *ngIf="IsNullorEmpty(currentProject.website)" href="{{ currentProject.website }}" target="_blank"> <i
        class="fas fa-globe icon icon"></i></a>
    <a *ngIf="IsNullorEmpty(currentProject.github)" href="{{ currentProject.github }}" target="_blank"> <i
        class="fa-fw fab fa-github icon"></i></a>
    <a *ngIf="IsNullorEmpty(currentProject.twitter)" href="{{ currentProject.twitter }}" target="_blank"><i
        class="fa-fw fab fa-twitter icon"></i></a>
    <a *ngIf="IsNullorEmpty(currentProject.discord)" href="{{ currentProject.discord }}" target="_blank"><i
        class="fa-fw fab fa-discord icon"></i></a>
    <a *ngIf="IsNullorEmpty(currentProject.facebook)" href="{{ currentProject.facebook }}" target="_blank"><i
        class="fa-fw fab fa-facebook icon"></i></a>
    <a *ngIf="IsNullorEmpty(currentProject.instagram)" href="{{ currentProject.instagram }}" target="_blank"> <i
        class="fab fa-instagram-square icon"></i></a>
  </div>

  <div class="col-md-3 project-info">
    <span>累積{{ currentProject.viewCount}}次瀏覽</span>
    <!--     <span>{{currentProject?.createdAt | date:"yyyy-MM-dd"}}</span> -->
    <span>{{currentProject.collectCount?currentProject.collectCount:0}}人收藏/{{currentProject.followCount}}人追蹤</span>
  </div>
</div>

<div *ngIf="currentProject" class="row mt-50">
  <div class="col-md-8">
    <div class="row mb-24">
      <div class="col-md-12">
        <span class="title mb-24">專案簡介</span>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 project_frame">
        <div class="tags">
          <ui-tag *ngIf="currentProject.isFindPartner" [class]="'tag-hiring'" [tag]="'徵成員'"></ui-tag>
          <ui-tag *ngIf="currentProject.isFunding" [class]="'tag-funding'" [tag]="'募資中'"></ui-tag>
          <ui-tag *ngIf="currentProject.isCofounder" [class]="'tag-cofounder'" [tag]="'找聯合創始人'"></ui-tag>
        </div>
        <span>{{this.currentProject.description?this.currentProject.description:"尚未填寫專案內容"}}</span>
        <div class="frame_bottom">
          <span class="title pb-8">目前進度</span>
          <div class="frame_bottom_items">
            <span class="stage_tag" *ngIf="currentProject?.stage.indexOf('idea') > -1">#已有創業概念</span>
            <span class="stage_tag" *ngIf="currentProject?.stage.indexOf('businessplan') > -1">#商業計畫初稿</span>
            <span class="stage_tag" *ngIf="currentProject?.stage.indexOf('fundraising') > -1">#募資中</span>
            <span class="stage_tag" *ngIf="currentProject?.stage.indexOf('findpartner') > -1">#找創業夥伴</span>
            <span class="stage_tag" *ngIf="currentProject?.stage.indexOf('buildMVP') > -1">#建構最小可行性產品(MVP)</span>
            <span class="stage_tag" *ngIf="currentProject?.stage.indexOf('producttested') > -1">#驗證產品中</span>
            <span class="stage_tag" *ngIf="currentProject?.stage.indexOf('findcustomers') > -1">#找用戶中</span>
            <span class="stage_tag" *ngIf="currentProject?.stage.indexOf('findpayingcustomers') > -1">#找付費用戶中</span>

          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="col-md-4">
    <div class="row mb-24">
      <div class="col-md-12">
        <span class="title mb-24">專案成員</span>
      </div>
    </div>
    <div class="row profile-frame">
      <div *ngIf="this.currentProject?.members">
        <ng-container *ngFor="let member of  this.currentProject.members ; let i = index">
          <ng-container *ngIf="onPage(i,this.currentPageIndex)">
            <div class="col-md-12 profile">
              <img class="profile-image rounded-circle" src="{{ member.imageUrl }}" (error)="onImgError($event)"
                alt="" />
              <div>
                <p class="profile-name">{{member.userName}}</p>
                <p class="position">{{member.position}}</p>
              </div>
            </div>
          </ng-container>
        </ng-container>
      </div>

      <div class="col-md-12 text-center dots">
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-8">
    <div class="row mb-24">
      <div class="col-md-12">
        <span class="title mb-24">近期動態</span>
      </div>
    </div>
    <div class="row ">
      <ng-container *ngIf="this.currentProject?.logs">
        <ng-container *ngFor="let log of  this.currentProject.logs; let i = index">
          <div class="col-md-12 history">

            <span>{{log.createdAt | date:"yyyy-MM-dd"}}</span><span>{{log.content}}</span>
          </div>
        </ng-container>
      </ng-container>
      <!-- <div class="col-md-12 frame-news">
        專案內容
      </div>
      <div class="col-md-12 frame-news">
        專案內容
      </div>
      <div class="col-md-12 frame-news">
        專案內容
      </div>
      <div class="col-md-12 frame-news">
        專案內容
      </div> -->
    </div>
  </div>
  <div class="col-md-4">
    <div class="row mb-24">
      <div class="col-md-12">
        <span class="title mb-24">專案成員募集中</span>
      </div>
    </div>
    <ng-container *ngIf="this.currentProject?.recruit">
      <ng-container *ngFor="let item of  this.currentProject.recruit; let i = index">
        <div class="row frame" [ngClass]="{'mt-10':i>1}">

          <div class="col-md-12" style="display: inline-flex;">
            <div class="col-md-8 pl-0">
              <p class="position"><b>{{item.position}}</b></p>
              <small>{{item.skills}}</small>
            </div>
            <div class="col-md-4 btn_items pr-0">
              <i *ngIf="item.isCollect" (click)="onClickUnCollect()" style="color:#56BDF4" class="fas fa-bookmark "></i>
              <i *ngIf="!item.isCollect" (click)="onClickCollect()" style="color:#56BDF4" class="far fa-bookmark "></i>
              <i class="far fa-envelope" style="color:#56BDF4" data-toggle="modal" data-target="#modal_apply"
                data-dismiss="modal" (click)="onSelectItem(item)"></i>
            </div>
          </div>

          <div class="col-md-12">
            {{item.scopes}}
          </div>
          <div class="col-md-12 text-right">
            <a class=" clickable" [routerLink]="['/job/',item.id ]" style="color: #4395E7;">查看詳情</a>
          </div>
        </div>
      </ng-container>
    </ng-container>

  </div>
</div>

<div [class.show]="isChat" class="full">
  <lab-custom-modal [open]="isChat" (close)="onToggleChat($event)">
    <h3 class="title" title>Chat</h3><span aria-hidden="true">X&times;</span>
    <div>
    </div>
    <lab-comments [currentUser]="currentUser" [receiverUser]="projectOwner" (close)="onToggleChat($event)" body>
    </lab-comments>

  </lab-custom-modal>

</div>


<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin-clockwise">
  <p style="color: white">Please Wait. </p>
</ngx-spinner>
<!--Modal login mail-->
<app-modal [modalid]="'modal_apply'">
  <div header>

  </div>
  <div body *ngIf="this.selectedApplication">
    <button type="button" class="close" #closebutton data-dismiss="modal" aria-label="Close">
      <span></span>
    </button>
    <div class="text-center mb-4">
      <h4>我要申請加入 {{this.selectedApplication.position}}</h4>
    </div>
    <div>
      <div class="form-group">
        <label for="application_message">我要有話要說</label>
        <textarea class="form-control rounded-0" [(ngModel)]="application_message" id="application_message"
          rows="3"></textarea>
      </div>
    </div>
    <div class="text-center mb-4">
      <button (click)="onSubmit(this.selectedApplication)" class="model_btn_normal mb-2 w-100">
        申請
      </button>
    </div>
  </div>
</app-modal>
